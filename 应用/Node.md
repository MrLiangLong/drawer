### 为什么要用Node
SEO   服务端渲染      
效率  前后端同构    
性能  首屏更快   

### 预防问题：压力估算和压测

1. 预测压力情况
    a. 200万请求/天(PV*平均请求书/页面)
    b. 预计80%的流量集中在20%的实际
    c. 集群RPS：2000000*0.8/(24*0.2*3600)=92.6RPS (峰值区间内，每秒的最大请求数)

2. 设置压测目标
    CPU   多核：30%(使用率不超过)
    内存  使用率不超过70%
    带宽  不成为瓶颈
    硬盘  使用率不超过70%

3. 执行压力测试
    a. 网络环境相同
    b. 独立的压力机
    c. 线上机器
        深夜压测
        混部，周知相关方

4. 部署上线
    集群机器数 = 期望RPS/单机实际RPS/0.7

### 预防问题:Code Review
    变量问题
    性能问题
    硬编码问题

### 异常监控：监控类型
    Nginx日志  
        499：nginx特有http status，客户端主动断开连接  
        404：页面中不存在资源   
        503  
    Node服务日志  
        Access.log: 客户端每一次请求  
        Api.log：发起一次api请求  
        Error.log: 所有的错误  
    慎用try catch  
        服务端慎用，可能给客户错误不准确数据，可用于错误上报  

### 资源监控
    CUP <40%    
    Memory <70%   






